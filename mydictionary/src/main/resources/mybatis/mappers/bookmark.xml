<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="bookmark">
<!-- 
<select id="findAll" resultType="bookmarkvo" parameterType="map">
<![CDATA[
	 select wordno, title, regDate, contents, link, keyword, thumbnail, description 
	 from bookmark where userno = #{userNo} and contents like '%${keyword}%' or title like  '%${keyword}%'  order by regDate desc limit #{start},#{showNum} 
]]>
</select>
-->
<select id="findAll" resultType="bookmarkvo" parameterType="map">
	<![CDATA[
	 select wordno, title, regDate, link, keyword, thumbnail, description 
	 from bookmark where userno = #{userNo} and (title like  '%${keyword}%' or description like '%${keyword}%') order by regDate desc limit #{start},#{showNum} 
	]]>
</select>
	
	<select id="findByWordNo" resultType="bookmarkvo" parameterType="long">
<![CDATA[
	select wordno, title, userNo, regDate,  link, keyword, thumbnail, description 
	from bookmark 
 	where wordNo = #{wordNo}
]]>
	</select>
	
	<select id="findByLink" resultType="int" parameterType="string">
<![CDATA[
	select count(*)
	from bookmark 
 	where link = #{link}
]]>
	</select>
		<select id="getCount" resultType="int" >
<![CDATA[
	SELECT count(*) FROM bookmark
]]>
	</select>
	
<!-- 
	<select id="paging" resultType="pagevo" parameterType="map">
<![CDATA[
	SELECT count(no) as total, CASE WHEN ceiling(count(no)/#{showNum})  = 0 THEN 1 ELSE ceiling(count(no)/#{showNum})  END AS totalpage FROM board where contents like '%${keyword}%' or title like  '%${keyword}%'
]]>
	</select>
	 -->
<insert id="insert" parameterType="bookmarkvo" >
	<![CDATA[
	insert into bookmark (wordno, title,  regDate, link, keyword, thumbnail, description, userno )
	 values (null, #{title},  now(), #{link}, #{keyword}, #{thumbnail} , #{description}, #{userNo})
	]]>
	<selectKey keyProperty="wordNo" order="AFTER" resultType="long"> 
	<![CDATA[
	select last_insert_id()
	]]>
	</selectKey>
	</insert>

<delete id="delete" parameterType="long">
	<![CDATA[
	delete from bookmark where wordNo = #{wordNo}
	]]>
</delete>
<delete id="deleteByLinkAndUserNo" parameterType="bookmarkvo">
	<![CDATA[
	delete from bookmark where link = #{link} and userNo = #{userNo}
	]]>
</delete>



<delete id="deleteAll"  >
	<![CDATA[
	delete from bookmark 
	]]>
</delete>
</mapper> 